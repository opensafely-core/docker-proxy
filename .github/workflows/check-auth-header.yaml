name: Check github auth header
on:
  schedule:
    # 09:00 UTC every day
    - cron: '0 9 * * *'
  workflow_dispatch:
env:
  EXPECTED: 'realm="https://ghcr.io/token",service="ghcr.io",scope="repository:user/image:pull"'
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
    - name: debug 1
      run: echo $EXPECTED"
    - name: debug 2
      run: curl -si https://ghcr.io/v2/ | grep -i www-authenticate | awk -F' ' '{print $3}'
    - name: check
      run: |
        test "$(curl -si https://ghcr.io/v2/ | grep -i www-authenticate | awk -F' ' '{print $3}')" = "$EXPECTED"
